-- docker run --name AhorraYa -e POSTGRES_USER=postgres -e POSTGRES_PASSWORD=root -e POSTGRES_DB=ahorra_ya -p 5432:5432 -d postgres

-- Creación de la tabla Usuario
CREATE TABLE Usuario(
    id_user UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    email VARCHAR(50) UNIQUE NOT NULL,
    password VARCHAR null,
    state BOOLEAN NOT NULL DEFAULT TRUE
);

-- Creación de la tabla Token
CREATE TABLE Token (
    id_token UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    token VARCHAR NOT NULL,
    fecha_creacion TIMESTAMP without time zone NULL DEFAULT CURRENT_TIMESTAMP,
    activo BOOLEAN NOT NULL DEFAULT TRUE,
    id_user UUID REFERENCES Usuario(id_user)
);

-- Creación de la tabla Departamento
CREATE TABLE Departamento (
    id_departamento UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL
);

-- Creación de la tabla Municipio
CREATE TABLE Municipio (
    id_municipio UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    id_departamento UUID NOT NULL REFERENCES Departamento(id_departamento)
);

-- Creación de la tabla Categoría
CREATE TABLE Categoria (
    id_categoria UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL
);

-- Creación de la tabla Tienda
CREATE TABLE Tienda (
    id_tienda UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    descripcion VARCHAR(255) NOT NULL,
    latitud DOUBLE PRECISION NOT NULL,
    longuitud DOUBLE PRECISION NOT NULL,
    id_departamento UUID NOT NULL REFERENCES Departamento(id_departamento),
    id_municipio UUID NOT NULL REFERENCES Municipio(id_municipio),
    direccion VARCHAR(255) NOT NULL,
    nombre_propietario VARCHAR(100),
    sitio_web VARCHAR(255),
    telefono VARCHAR(20),
    correo_electronico VARCHAR(60)
);

-- Creación de la tabla Oferta
CREATE TABLE Oferta (
    id_oferta UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    nombre VARCHAR(200) NOT NULL,
    descripcion VARCHAR(255) NOT NULL,
    precio_anterior FLOAT,
    precio_actual FLOAT NOT NULL,
    fecha_inicio VARCHAR NOT NULL,
    fecha_fin VARCHAR NOT NULL,
    activo BOOLEAN NOT NULL DEFAULT TRUE,
    id_tienda UUID NOT NULL REFERENCES Tienda(id_tienda)
    id_categoria UUID NOT NULL REFERENCES Categoria(id_categoria)
);

-- Creación de la tabla Favorito
CREATE TABLE Favorito (
    id_favorito UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    id_user UUID NOT NULL REFERENCES Usuario(id_user),
    id_tienda UUID NOT NULL REFERENCES Tienda(id_tienda)
);

-- Creación de la tabla Imagen
CREATE TABLE Imagen (
    id_imagen UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    url VARCHAR NOT NULL,
    id_tienda UUID REFERENCES Tienda(id_tienda),
    id_oferta UUID REFERENCES Oferta(id_oferta)
);
